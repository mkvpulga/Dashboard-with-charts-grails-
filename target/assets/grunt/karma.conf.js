"use strict";var ip=require("ip"),browserConfig=require("./browsers"),browserStack="true"===process.env.BROWSER;module.exports=function(config){var conf={basePath:"../",frameworks:["qunit"],plugins:["karma-qunit"],files:["js/tests/vendor/jquery.min.js","js/tooltip.js","js/!(tooltip).js","js/tests/unit/*.js"],reporters:["dots"],port:9876,colors:!0,logLevel:config.LOG_ERROR||config.LOG_WARN,autoWatch:!1,singleRun:!0,concurrency:1/0,client:{qunit:{showUI:!0}}};browserStack?(conf.hostname=ip.address(),conf.browserStack={username:process.env.BROWSER_STACK_USERNAME,accessKey:process.env.BROWSER_STACK_ACCESS_KEY,build:"bootstrap-v3-"+(new Date).toISOString(),project:"Bootstrap v3",retryLimit:1},conf.plugins.push("karma-browserstack-launcher"),conf.customLaunchers=browserConfig.list,conf.browsers=browserConfig.keys,conf.reporters.push("BrowserStack")):(conf.frameworks.push("detectBrowsers"),conf.plugins.push("karma-chrome-launcher","karma-firefox-launcher","karma-detect-browsers"),conf.detectBrowsers={usePhantomJS:!1,postDetection:function(availableBrowser){if("undefined"!=typeof process.env.TRAVIS_JOB_ID||availableBrowser.includes("Chrome"))return["ChromeHeadless"];if(availableBrowser.includes("Firefox"))return["FirefoxHeadless"];throw new Error("Please install Firefox or Chrome")}},conf.customLaunchers={FirefoxHeadless:{base:"Firefox",flags:["-headless"]}}),config.set(conf)};